{% extends "base.html" %}

{% block content %}

  <div class="row">

    <div>
        <h2>Study</h2>
        <h3>Temperature</h3>
        <div id="temperature_study_chart"></div>

        <h3>Humidity</h3>
        <div id="humidity_study_chart"></div>
    </div>

    <div>
        <h2>Kitchen</h2>
        <h3>Temperature</h3>
        <div id="temperature_kitchen_chart"></div>

        <h3>Humidity</h3>
        <div id="humidity_kitchen_chart"></div>
    </div>

    <div>
        <h2>Bathroom</h2>
        <h3>Temperature</h3>
        <div id="temperature_bathroom_chart"></div>

        <h3>Humidity</h3>
        <div id="humidity_bathroom_chart"></div>
    </div>

    <div>
        <h2>Livingroom</h2>
        <h3>Temperature</h3>
        <div id="temperature_livingroom_chart"></div>

        <h3>Humidity</h3>
        <div id="humidity_livingroom_chart"></div>
    </div>


    <div>
        <h2>Bedroom</h2>
        <h3>Temperature</h3>
        <div id="temperature_bedroom_chart"></div>

        <h3>Humidity</h3>
        <div id="humidity_bedroom_chart"></div>
    </div>


    <div>
        <h2>Front Door</h2>
        <h3>Temperature</h3>
        <div id="temperature_front_door_chart"></div>

        <h3>Humidity</h3>
        <div id="humidity_livingroom_chart"></div>
    </div>

    <div>
        <h2>Electricity</h2>
        <h3>Current Watts</h3>
        <div id="electricity_electricity_chart"></div>

        <h3>Total Watts</h3>
        <div id="total_watts_electricity_chart"></div>
    </div>

  </div>

{% endblock %}

{% block js %}

<script type="text/javascript">

$(function(){

    var tv = 500;


    var graph_factory = function(id, device, start, end){

        var element_name = id + '_' + device + '_chart';

        var url = '/data/' + id + '/' + device + '/' + start + '/' + end + '/';

        d3.json(url, function(data) {

            var series = data.series;

            var min = Math.min(series[0].min, series[1].min);
            var min = min * 0.95;
            var max = Math.max(series[0].max, series[1].max);
            var max = max * 1.05;

            var scaler = d3.scale.linear().domain([min, max]).nice();

            $.each(series, function(x, dict){
                dict.scale = scaler;
                $.each(dict.data, function(y, point){
                    point.x = Date.parse(point.x) / 1000;
                });
            });

            var graph = new Rickshaw.Graph({
                element: document.getElementById(element_name),
                width: 690,
                height: 160,
                renderer: 'multi',
                series: series,
                interpolation: 'linear',
            });

            var x_axis = new Rickshaw.Graph.Axis.Time({
                graph: graph
            });
            var y_axis = new Rickshaw.Graph.Axis.Y.Scaled({
                graph: graph,
                tickFormat: Rickshaw.Fixtures.Number.formatKMBT,
                scale: scaler
            });

            var hoverDetail = new Rickshaw.Graph.HoverDetail( {
                graph: graph
            } );

            graph.render();


        })

    }

    var s = "2014-03-25%2000:00";
    var e = "2014-04-01%2000:00";

    graph_factory("temperature", 'study', s, e);
    graph_factory("humidity", 'study', s, e);
    graph_factory("temperature", 'kitchen', s, e);
    graph_factory("humidity", 'kitchen', s, e);
    graph_factory("temperature", 'bathroom', s, e);
    graph_factory("humidity", 'bathroom', s, e);
    graph_factory("temperature", 'livingroom', s, e);
    graph_factory("humidity", 'livingroom', s, e);
    graph_factory("electricity", 'electricity', s, e);
    graph_factory("total_watts", 'electricity', s, e);

});


</script>

{% endblock %}
